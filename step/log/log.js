var util=require("../../utils/helper.js"),utils=getApp().helper;Page({data:{currency:0,bout_ratio:0,total_bout:0,bout:0,page:2,list:[{name:""},{step_num:0},{user_currency:0},{user_num:0},{status:0}]},onReachBottom:function(){var e=this,o=e.data.over;if(!o){var i=this.data.list,r=this.data.page;this.setData({loading:!0}),getApp().request({url:getApp().api.step.activity_log,data:{page:r},success:function(t){for(var a=0;a<t.data.list.length;a++)i.push(t.data.list[a]);t.data.list.length<10&&(o=!0),e.setData({list:i,page:r+1,loading:!1,over:o})}})}},onLoad:function(t){getApp().page.onLoad(this,t);var r=this,a=util.formatTime(new Date),s=a[0]+a[1]+a[2]+a[3]+a[5]+a[6]+a[8]+a[9];getApp().core.showLoading({title:"数据加载中...",mask:!0}),getApp().request({url:getApp().api.step.activity_log,success:function(t){getApp().core.hideLoading();var a=t.data.info,e=0;0<a.currency&&(e=a.currency);for(var o=t.data.list,i=0;i<o.length;i++)null!=o[i].open_date&&(o[i].date=o[i].open_date.replace("-","").replace("-",""));r.setData({currency:e,bout_ratio:a.bout_ratio,total_bout:a.total_bout,bout:a.bout,time:s,list:o})}})}});